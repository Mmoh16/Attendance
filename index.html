<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Class Attendance</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
    :root {
        /* Define your new colors here */
        --main-color: #EFE9E0;
        --secondary-color: #0F9E99;
        --text-color: #333333;
    }

    body {
        background-color: var(--main-color);
        color: var(--text-color);
        font-family: Arial, sans-serif;
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }

    /* Example: Chat Box or Container */
    .chat-container {
        background-color: #ffffff; /* White container to contrast with main color */
        border: 2px solid var(--secondary-color);
        border-radius: 15px;
        width: 400px;
        overflow: hidden;
    }

    /* Example: Header */
    .chat-header {
        background-color: var(--secondary-color);
        color: white;
        padding: 15px;
        text-align: center;
    }

    /* Example: Buttons */
    button {
        background-color: var(--secondary-color);
        color: white;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        border-radius: 5px;
    }

    button:hover {
        opacity: 0.9;
    }
</style>
</head>
<body class="flex items-center justify-center min-h-screen p-4"> <div class="w-full max-w-md mx-auto bg-white rounded-3xl shadow-2xl p-8 space-y-8 transform transition-all duration-300 hover:scale-[1.01]">
    
    <div id="main-title" class="text-center">
      <h1 class="text-4xl font-extrabold text-gray-900 leading-tight">Exams Course Attendance</h1>
      <p class="text-gray-600 mt-3 text-lg">Ø§Ø­Ù„Ù Ø§Ù†Ùƒ Ù‡ØªØ±ÙƒØ² ÙˆÙ…Ø´ Ù‡ØªØªØ¹Ø¨Ù†Ø§ Ù…Ø¹Ø§Ùƒ ğŸ¥º!</p>
    </div>

    <div id="selection-form" class="space-y-6">
      <div>
        <label for="student-select" class="block text-gray-700 text-sm font-semibold mb-2">Select your name:</label>
        <select id="student-select" class="block w-full px-5 py-3 text-lg text-gray-900 border border-gray-300 rounded-xl bg-gray-50 focus:ring-purple-500 focus:border-purple-500 shadow-sm transition-all duration-200 ease-in-out hover:border-purple-400">
          <option value="" selected disabled>-- Choose your name --</option>
        </select>
      </div>
      <button id="confirm-btn" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3.5 px-4 rounded-xl text-lg shadow-lg transform hover:-translate-y-1 transition-all duration-200 ease-in-out">
        Confirm Attendance
      </button>
    </div>

    <div id="zoom-section" class="hidden text-center pt-6 border-t border-gray-200 animate-fadeInSlideUp">
      <h2 class="text-2xl font-bold text-green-700 mb-3">Ø®Ø´ Ø¨Ø³Ø±Ø¹Ù‡ ÙˆØ§ÙØªØ­ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ğŸ”«</h2>
      <p class="text-gray-700 mt-2 mb-5 text-lg">Ù„Ùˆ Ù…Ø´ ÙØ§Ù‡Ù… Ø­Ø§Ø¬Ù‡ Ø§Ø³Ø¦Ø§Ù„ Ø§Ù„Ù…Ø³ØªØ± ÙÙŠÙ‡Ø§</p>
      <div class="text-left bg-green-50 p-6 rounded-xl space-y-3 border border-green-200 shadow-md">
        <p class="text-gray-800 text-lg"><strong>Meeting ID:</strong> <span id="zoom-id" class="font-medium text-green-800"></span></p>
        <p class="text-gray-800 text-lg"><strong>Password:</strong> <span id="zoom-password" class="font-medium text-green-800"></span></p>
      </div>
      <a id="zoom-link" href="#" target="_blank" class="mt-6 inline-block w-full bg-gray-800 hover:bg-gray-900 text-white font-semibold py-3.5 px-6 rounded-xl text-lg shadow-md transform hover:-translate-y-1 transition-all duration-200 ease-in-out">
        ğŸš€ Join Zoom Meeting
      </a>
    </div>
  </div>

  <script>
    const ATTENDANCE_WEBHOOK_URL = 'https://api.mark-attendance.com/webhook/log-attendance';
    const classData = {"zoomInfo":{"zoomLink":"ADV","zoomId":"EFWA","zoomPassword":"CA"},"studentList":["Abadeer Romany","Abanob Hany Mahrousse Basta","Abdel Rahman Mohamed Nabil","Abdelghfar Essam Ali","Abdelmenim hamada","Abdelrhman rafat zayan","Abram Elkomos brnaba","Ahmed Abo Bakr ahmed","Ahmed ehab elkordy","Ahmed ehab fayez","Ahmed Hamada","Ahmed hesham mostafa","Ahmed mohamed ahmed abdelhakam","Ahmed Mohamed Hamed","Ahmed Omar Yousef","Ahmed Saleh","Ahmed sherif","Ahmed Yasser","Ali hazem abdelrouf","Ali Tarek Abdelraouf abdelhamed","Alia Hisham Diab","Amir Ishak Edward","Amr ahmed mostafa","Amr Eisa","Anas Mohamed Essam","Anasemon Armia kamal","Antony Ashraf Raouf","Aseel Adel","Aster Nasser","Aya wael","Ayten khalil","Basmala Hamdy Gomaa","BAVLY YOUHANNA","bishoy ayman","Ceril sameh","Dani Petro Emad","Daniel adel","Dareen soliman","Elaria hany makar","Eman wael farouk farid aboushady","Ereny Elkomos brnaba","Eslam Ahmed abdelmoniem","Esraa gomaa","Estafros Ehab","FADY JOSEPH","Fady Malak Noshy","Fady rady","Farah waheed","Fares","Fares Ahmed Farrag","Farida ayman salah ahmed","farida mohamed sameh","Farida sameh omar","Fatima abdelaal","Fatma Mohamed Ali","Galal elsharawy","Gana Ragab Hassan","Ganna emad salah","Ganna shaker","Ganna shaker","George Amgad Sorial","George Emad fayez habieb","George Magdy","Habiba Abdelatty","Habiba Ahmed Ismael","Habiba Ahmed moustaf elnabawie","Habiba mohamed","Hagar hassan zakaria","Haidy amen","hamza mohamed ibrahem","Hana ehab mohamed samer arafa","Hana haithem elseihy","Hana lofty salem","Hana Zakarya","Hannah ali massoud","Hannah youssef yacoub","Hassan Islam hamdy","Haya mahmoud","Haya Yasser Helmy","helana hany","Hla mohamed abo Zaid","Ibrahim Mahmoud Elzare3","Jana mohamed","Jana mohamed Ahmed","Jana mohamed hamdy","Jannat Ahmed Mohamed","jasmine mina","Jasseca Nashat","Jessica Malak Botros","Jessy amir","Jola hany Maher","Joseph hany lwiez","Josiana Ehab Hosny","Judy Hany Rashad Gaber","Julia George Nagdy","Jumana Ayman Mohamed","kareem ahmad mohammed","Kareem Ashraf","Karim Ahmed Maher","Karolin ayman","Kenzy ahmed ali","Kenzy Amr","Kenzy Metwalli","Kenzy mohamed emad","Kenzy Mohamed kamal","Kermena Romany","kermena Romany","Kero Hany rasmy","Kerollos hany samir","Kerolos Eid makram","Kerolos Milad Genedy","Kerolus wael","Khloud magdy","Lara Sherif","Lavinia Ayman","Lina Ali mohamed","lojain mahmoud hamza","Loren gerges","lyanhaithamatef","Magdy Ezz Alarab Gad","Mahmoud hany","Mahmoud Mohamed Reyad","mahmoud sayed","Mai Osama Sekina","malak ahmed mohamed amer","Malak Elmaghraby","Malak emad eldin mohamed","Malak fouad","Malak wael Ibrahim Mohammed Shahin","malaq tarek yusif mostafa","Malek amr","Manwella Raafat","Mariam ahmed abdel monem","Mariam ahmed abo el maarf","Mariam ahmed mohamed","Mariam eldairy","Mariam elkess rois","mariam essam","Mariam Mahmoud ezz","Mariam Mahmoud Mahrous Ahmed Ali Emara","Mariam Mohamed Gholam Nabi","Mariam samouel","Mariam Zakaria mohy eldeen","Marian Saeed badry","Mariem Osama taha","Marina Atef Younan","Mariz boles gerges","Mark Basem Magdy","Mark Samy Morcos","Mark sheren nassan","maroska","Martin romany","Marven Amin Nabil Shaker","Marwan Hany","marwan reda hussein","Marween Ayman","Maryam maher","Matthew basem","Maura Emad Fayez","May Mostafa","Mazen hossam aid","menna ali","Menna Ashref kamal","Menna Badreldeen Hassan","Mennatullah Talaat Abdelfattah","Meriam Waffik William","Merola wael","Merolla safwat","Mina Hany","minour maged","Miracle Remon Refaat","Moaz Ahmed Hassan","Moez sleem","Mohamed  Ahmed","Mohamed ahmed elaiary","Mohamed Ahmed Fawzy","Mohamed Ayman Elnaggar","Mohamed ayman Fayad","Mohamed emad","Mohamed Hussien","Mohamed Mostafa","Mohamed Nabil Abdalazeem","mohamed yasser","Monica Mokhles Shawky","Mostafa Mohamed Aly Ragaee","Moustafa Mahmoud Elsherif","muhrail adel shenouda","muhral maged","Nada Mohamed","Naira Nabil","Natalie Michael","Nejar Walid Makram","Noha Jad","Noha Samy mohamed hassan","Noor Abd El Razek","Nora Ahmed Radwan","Nora hassan hamza","Nour alaa Mohamed","Nour amr","Nouran Essam","Nouran Hamada Mohammed","Nourhan Ashraf","Omar Kadry","Omar Mahrous","omar Mohamed elsayed","Osama ahmed Khalifa","Osama Mohamed","Pater Mina","Patrick ayman wadee","Peri wael","Pier Elia","Priscilla Naeim","Rahma Eid Abd Elwaha","rahma hafez","Rawan abdelkareem fathy okily","Remonda Remon Ezzat","Renad Atef Hussein","Roaa Khaled","Robin Micheal hosney","Rony shaker abdo","Rozalia refaat","Rozan mohamed ali","Sahar Maher","Sahar Mohamed elkawas","Sally Gamil","Salma ashraf mohamed","Salma reda maher","Sama Mahmoud aboeldahab","Sama Mohamed","Samar Ali Sayed","Samy Mohamed Samy","Sandy sameh","Sara Michael","Sarah Lawrence","Selena mikeal morad","Shady moody sobhy amin","Shrouk Shehab Salah","Silvia sameh","Sofia shahir helmy","Sondos Ahmed gamal","Sondos negm","Steven Sameh","Taha mahmoud Ahmed","Thomas Atef Ayad","Usama Hassan Ahmed","Ussif fawzy","Wateen Mostafa Ragab","Yahia mohamed yousef","Yarah Abdelnaby Aly","yassen amar","Yassin Taha Makram","Youana Biskales Eskarous","Youana Eshak ibram","youana osama","yousef ashraf ali","Youssef amr hussin","Youssef emad samy","Youssef gamal","Youssef maged","Youssef Medhat Botros","Youssef Mohammed Gaber","Youssef Sameh Gad El-Sayed Khala","Zamzam Ahmed Mohamed","Zeina ehab elsafty","Zeyad sherif elsaid","Ziad Sherif ali"],"meetingId":"1765204346972"};
    const zoomInfo = classData.zoomInfo || {};
    
    // Get the unique meeting ID from the n8n data
    const meetingId = classData.meetingId || 'default_session';
    // The storage key is now tied to this unique ID
    const ATTENDANCE_KEY = 'attendanceTaken_' + meetingId;
    
    const studentSelect = document.getElementById('student-select');
    const confirmBtn = document.getElementById('confirm-btn');
    const zoomSection = document.getElementById('zoom-section');
    const mainTitle = document.getElementById('main-title');
    const selectionForm = document.getElementById('selection-form');

    function showZoomInfo() {
      document.getElementById('zoom-id').textContent = zoomInfo.zoomId || '';
      document.getElementById('zoom-password').textContent = zoomInfo.zoomPassword || '';
      document.getElementById('zoom-link').href = zoomInfo.zoomLink || '#';
      
      zoomSection.classList.remove('hidden');
      if (mainTitle) mainTitle.style.display = 'none';
      if (selectionForm) selectionForm.style.display = 'none';
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Check for the unique attendance key
      const attendedName = localStorage.getItem(ATTENDANCE_KEY);
      
      if (attendedName) {
        // If they already attended *this session*, show info
        showZoomInfo();
      } else {
        // This is a new session, so show the names
        (classData.studentList || []).forEach(name => {
          const option = document.createElement('option');
          option.value = name;
          option.textContent = name;
          studentSelect.appendChild(option);
        });
      }
    });

    confirmBtn.addEventListener('click', async () => {
      const selectedOption = studentSelect.options[studentSelect.selectedIndex];
      if (!selectedOption || !selectedOption.value) {
        alert("Please select your name first.");
        return;
      }

      const studentName = selectedOption.value;

      try {
        confirmBtn.textContent = 'Confirming...';
        confirmBtn.disabled = true;

        const resp = await fetch(ATTENDANCE_WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name: studentName }),
        });

        const respText = await resp.text();
        if (!resp.ok) {
          console.error('Server returned non-OK status', resp.status, respText);
          alert('Could not log attendance. Please try again.');
          confirmBtn.textContent = 'Confirm Attendance';
          confirmBtn.disabled = false;
          return;
        }
        
        console.log('Attendance logged:', respText);
        
        // Save using the unique attendance key
        localStorage.setItem(ATTENDANCE_KEY, studentName);
        
        showZoomInfo();

      } catch (err) {
        console.error('Fetch error:', err);
        alert('Could not log attendance. Please try again.');
        confirmBtn.textContent = 'Confirm Attendance';
        confirmBtn.disabled = false;
      }
    });
  </script>
</body>
</html>